<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>MP填坑之路-Lynwood</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:first-child { margin-top: -20px; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  #write { margin-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="mermaid"] svg, [lang="flow"] svg { max-width: 100%; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }


:root { --side-bar-bg-color: #fafafa; --control-text-color: #777; }
@font-face { font-family: "Open Sans"; font-style: normal; font-weight: normal; src: local("Open Sans Regular"), url("./github/400.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: normal; src: local("Open Sans Italic"), url("./github/400i.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: normal; font-weight: bold; src: local("Open Sans Bold"), url("./github/700.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: bold; src: local("Open Sans Bold Italic"), url("./github/700i.woff") format("woff"); }
html { font-size: 16px; }
body { font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; color: rgb(51, 51, 51); line-height: 1.6; }
#write { max-width: 860px; margin: 0px auto; padding: 30px 30px 100px; }
#write > ul:first-child, #write > ol:first-child { margin-top: 30px; }
a { color: rgb(65, 131, 196); }
h1, h2, h3, h4, h5, h6 { position: relative; margin-top: 1rem; margin-bottom: 1rem; font-weight: bold; line-height: 1.4; cursor: text; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor { text-decoration: none; }
h1 tt, h1 code { font-size: inherit; }
h2 tt, h2 code { font-size: inherit; }
h3 tt, h3 code { font-size: inherit; }
h4 tt, h4 code { font-size: inherit; }
h5 tt, h5 code { font-size: inherit; }
h6 tt, h6 code { font-size: inherit; }
h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom: 1px solid rgb(238, 238, 238); }
h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom: 1px solid rgb(238, 238, 238); }
h3 { font-size: 1.5em; line-height: 1.43; }
h4 { font-size: 1.25em; }
h5 { font-size: 1em; }
h6 { font-size: 1em; color: rgb(119, 119, 119); }
p, blockquote, ul, ol, dl, table { margin: 0.8em 0px; }
li > ol, li > ul { margin: 0px; }
hr { height: 2px; padding: 0px; margin: 16px 0px; background-color: rgb(231, 231, 231); border: 0px none; overflow: hidden; box-sizing: content-box; }
li p.first { display: inline-block; }
ul, ol { padding-left: 30px; }
ul:first-child, ol:first-child { margin-top: 0px; }
ul:last-child, ol:last-child { margin-bottom: 0px; }
blockquote { border-left: 4px solid rgb(223, 226, 229); padding: 0px 15px; color: rgb(119, 119, 119); }
blockquote blockquote { padding-right: 0px; }
table { padding: 0px; word-break: initial; }
table tr { border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px; }
table tr:nth-child(2n), thead { background-color: rgb(248, 248, 248); }
table tr th { font-weight: bold; border-width: 1px 1px 0px; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; border-bottom-style: initial; border-bottom-color: initial; text-align: left; margin: 0px; padding: 6px 13px; }
table tr td { border: 1px solid rgb(223, 226, 229); text-align: left; margin: 0px; padding: 6px 13px; }
table tr th:first-child, table tr td:first-child { margin-top: 0px; }
table tr th:last-child, table tr td:last-child { margin-bottom: 0px; }
.CodeMirror-lines { padding-left: 4px; }
.code-tooltip { box-shadow: rgba(0, 28, 36, 0.3) 0px 1px 1px 0px; border-top: 1px solid rgb(238, 242, 242); }
.md-fences, code, tt { border: 1px solid rgb(231, 234, 237); background-color: rgb(248, 248, 248); border-radius: 3px; padding: 2px 4px 0px; font-size: 0.9em; }
code { background-color: rgb(243, 244, 244); padding: 0px 4px 2px; }
.md-fences { margin-bottom: 15px; margin-top: 15px; padding: 8px 1em 6px; }
.md-task-list-item > input { margin-left: -1.3em; }
@media print {
  html { font-size: 13px; }
  table, pre { break-inside: avoid; }
  pre { word-wrap: break-word; }
}
.md-fences { background-color: rgb(248, 248, 248); }
#write pre.md-meta-block { padding: 1rem; font-size: 85%; line-height: 1.45; background-color: rgb(247, 247, 247); border: 0px; border-radius: 3px; color: rgb(119, 119, 119); margin-top: 0px !important; }
.mathjax-block > .code-tooltip { bottom: 0.375rem; }
.md-mathjax-midline { background: rgb(250, 250, 250); }
#write > h3.md-focus::before { left: -1.5625rem; top: 0.375rem; }
#write > h4.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h5.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h6.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
.md-image > .md-meta { border-radius: 3px; padding: 2px 0px 0px 4px; font-size: 0.9em; color: inherit; }
.md-tag { color: rgb(167, 167, 167); opacity: 1; }
.md-toc { margin-top: 20px; padding-bottom: 20px; }
.sidebar-tabs { border-bottom: none; }
#typora-quick-open { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); }
#typora-quick-open-item { background-color: rgb(250, 250, 250); border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238); border-style: solid; border-width: 1px; }
.on-focus-mode blockquote { border-left-color: rgba(85, 85, 85, 0.12); }
header, .context-menu, .megamenu-content, footer { font-family: "Segoe UI", Arial, sans-serif; }
.file-node-content:hover .file-node-icon, .file-node-content:hover .file-node-open-state { visibility: visible; }
.mac-seamless-mode #typora-sidebar { background-color: var(--side-bar-bg-color); }
.md-lang { color: rgb(180, 101, 77); }
.html-for-mac .context-menu { --item-hover-bg-color: #E6F0FE; }
#md-notification .btn { border: 0px; }
.dropdown-menu .divider { border-color: rgb(229, 229, 229); }





 .typora-export p, .typora-export .footnote-line {white-space: normal;} 
</style>
</head>
<body class='typora-export os-windows' style="background: #FFFFCC" >
<div  id='write'  class = 'is-node'><h1><a name='header-n0' class='md-header-anchor '></a>Mybatis-Plus 我来填坑~</h1><h4><a name='header-n2' class='md-header-anchor '></a>简介： </h4><p><span>	</span>此Demo 主要应用SpringBoot 来展示<strong>Mybatis-Plus</strong> 特性， 以及在开发过程中可能应用到的插件的演示。</p><p><span>	</span><strong>源码：<a href='https://github.com/wunian7yulian/MybatisPlusDemo' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo</a></strong></p><p><span>	</span><strong>本文：<a href='https://wunian7yulian.github.io/MybatisPlusDemo/' target='_blank' class='url'>https://wunian7yulian.github.io/MybatisPlusDemo/</a></strong></p><hr /><ul><li><p><strong>相同于 <a href='https://mybatis.plus/guide/'>MyBatis官方指南</a> 中有了详细介绍</strong></p><p><strong>不同于 实践演示</strong><span>	</span></p></li></ul><hr /><ul><li><p><strong>目的:</strong></p><p>主要借此做为突破口， <strong>一是</strong>将自我学习成文记录下来， <strong>二是</strong>将Demo 慢慢做成一个自己或者面向大众的后端脚手架工具。</p></li><li><p><strong>规划</strong>：</p><p><em>分享-实践-填坑-总结-脚手架-分享-实践......</em>  </p><p><span>	</span></p></li></ul><h2><a name='header-n20' class='md-header-anchor '></a>目录</h2><div class='md-toc' mdtype='toc'><p class="md-toc-content"><span class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" href="#header-n0">Mybatis-Plus 我来填坑~</a></span><span class="md-toc-item md-toc-h4" data-ref="n2"><a class="md-toc-inner" href="#header-n2">简介： </a></span><span class="md-toc-item md-toc-h2" data-ref="n20"><a class="md-toc-inner" href="#header-n20">目录</a></span><span class="md-toc-item md-toc-h2" data-ref="n22"><a class="md-toc-inner" href="#header-n22">一、简单介绍</a></span><span class="md-toc-item md-toc-h3" data-ref="n24"><a class="md-toc-inner" href="#header-n24">官方说明 ：</a></span><span class="md-toc-item md-toc-h3" data-ref="n36"><a class="md-toc-inner" href="#header-n36">成绩：</a></span><span class="md-toc-item md-toc-h3" data-ref="n38"><a class="md-toc-inner" href="#header-n38">最新版本：</a></span><span class="md-toc-item md-toc-h3" data-ref="n40"><a class="md-toc-inner" href="#header-n40">开发层面MyBatis-Plus特色</a></span><span class="md-toc-item md-toc-h3" data-ref="n46"><a class="md-toc-inner" href="#header-n46">Mybatis-Plus中的Plus</a></span><span class="md-toc-item md-toc-h2" data-ref="n49"><a class="md-toc-inner" href="#header-n49">二、MP的特性</a></span><span class="md-toc-item md-toc-h2" data-ref="n81"><a class="md-toc-inner" href="#header-n81">三、MP框架结构</a></span><span class="md-toc-item md-toc-h2" data-ref="n85"><a class="md-toc-inner" href="#header-n85">四、简单的入门Demo(Mysql)</a></span><span class="md-toc-item md-toc-h4" data-ref="n86"><a class="md-toc-inner" href="#header-n86">Demo代码地址：</a></span><span class="md-toc-item md-toc-h4" data-ref="n88"><a class="md-toc-inner" href="#header-n88">Demo 环境： </a></span><span class="md-toc-item md-toc-h4" data-ref="n93"><a class="md-toc-inner" href="#header-n93">初始化：</a></span><span class="md-toc-item md-toc-h5" data-ref="n94"><a class="md-toc-inner" href="#header-n94">数据库：MySql</a></span><span class="md-toc-item md-toc-h6" data-ref="n96"><a class="md-toc-inner" href="#header-n96">DDL:</a></span><span class="md-toc-item md-toc-h6" data-ref="n98"><a class="md-toc-inner" href="#header-n98">DML:</a></span><span class="md-toc-item md-toc-h4" data-ref="n100"><a class="md-toc-inner" href="#header-n100">工程：</a></span><span class="md-toc-item md-toc-h5" data-ref="n102"><a class="md-toc-inner" href="#header-n102">第一步、创建工程</a></span><span class="md-toc-item md-toc-h5" data-ref="n105"><a class="md-toc-inner" href="#header-n105">第二步、引入依赖坐标</a></span><span class="md-toc-item md-toc-h5" data-ref="n107"><a class="md-toc-inner" href="#header-n107">第三步、配置数据源</a></span><span class="md-toc-item md-toc-h5" data-ref="n110"><a class="md-toc-inner" href="#header-n110">第四步、添加mybatis扫描位置</a></span><span class="md-toc-item md-toc-h5" data-ref="n112"><a class="md-toc-inner" href="#header-n112">第五步、pojo及mapper</a></span><span class="md-toc-item md-toc-h5" data-ref="n117"><a class="md-toc-inner" href="#header-n117">第六步、测试</a></span><span class="md-toc-item md-toc-h2" data-ref="n121"><a class="md-toc-inner" href="#header-n121">五、核心功能</a></span><span class="md-toc-item md-toc-h3" data-ref="n122"><a class="md-toc-inner" href="#header-n122">核心一-简便之-代码生成器（AutoGenerator）</a></span><span class="md-toc-item md-toc-h4" data-ref="n124"><a class="md-toc-inner" href="#header-n124">Demo代码地址：</a></span><span class="md-toc-item md-toc-h4" data-ref="n126"><a class="md-toc-inner" href="#header-n126">Demo 环境： </a></span><span class="md-toc-item md-toc-h4" data-ref="n128"><a class="md-toc-inner" href="#header-n128">工程：</a></span><span class="md-toc-item md-toc-h5" data-ref="n130"><a class="md-toc-inner" href="#header-n130">第一步、创建模块</a></span><span class="md-toc-item md-toc-h5" data-ref="n132"><a class="md-toc-inner" href="#header-n132">第二步、引入依赖坐标</a></span><span class="md-toc-item md-toc-h5" data-ref="n135"><a class="md-toc-inner" href="#header-n135">第三步、编写代码生成器</a></span><span class="md-toc-item md-toc-h5" data-ref="n138"><a class="md-toc-inner" href="#header-n138">第四步、运行测试</a></span><span class="md-toc-item md-toc-h5" data-ref="n146"><a class="md-toc-inner" href="#header-n146"><strong>发现问题</strong>： 如果是多模块项目 生成的文件会直接到了父项目目录下</a></span><span class="md-toc-item md-toc-h6" data-ref="n148"><a class="md-toc-inner" href="#header-n148">解决方法：</a></span><span class="md-toc-item md-toc-h3" data-ref="n159"><a class="md-toc-inner" href="#header-n159">核心二 - 清晰之-CRUD接口</a></span><span class="md-toc-item md-toc-h4" data-ref="n160"><a class="md-toc-inner" href="#header-n160">Demo代码地址：</a></span><span class="md-toc-item md-toc-h4" data-ref="n167"><a class="md-toc-inner" href="#header-n167">工程：</a></span><span class="md-toc-item md-toc-h5" data-ref="n168"><a class="md-toc-inner" href="#header-n168">第一步、创建模块</a></span><span class="md-toc-item md-toc-h5" data-ref="n170"><a class="md-toc-inner" href="#header-n170">第二步、引入依赖坐标</a></span><span class="md-toc-item md-toc-h5" data-ref="n176"><a class="md-toc-inner" href="#header-n176">第三步、生成代码</a></span><span class="md-toc-item md-toc-h5" data-ref="n188"><a class="md-toc-inner" href="#header-n188">第四步、其他配置需要</a></span><span class="md-toc-item md-toc-h5" data-ref="n197"><a class="md-toc-inner" href="#header-n197">第五步、对MP探个究竟！</a></span><span class="md-toc-item md-toc-h5" data-ref="n214"><a class="md-toc-inner" href="#header-n214"><strong>发现问题</strong>:  我虽然看到了方法 但是并没有一条SQL 那么它是怎样做到查询的呢?</a></span><span class="md-toc-item md-toc-h6" data-ref="n215"><a class="md-toc-inner" href="#header-n215">探索:</a></span><span class="md-toc-item md-toc-h5" data-ref="n241"><a class="md-toc-inner" href="#header-n241">第六步、使用它</a></span><span class="md-toc-item md-toc-h6" data-ref="n245"><a class="md-toc-inner" href="#header-n245">Mapper - 简单的CRUD:</a></span><span class="md-toc-item md-toc-h5" data-ref="n247"><a class="md-toc-inner" href="#header-n247"><strong>发现问题</strong>: 虽然MP替我生成了 uuid 作为主键,但是还是想用数据库自增形式主键怎么办?</a></span><span class="md-toc-item md-toc-h6" data-ref="n248"><a class="md-toc-inner" href="#header-n248">解决:</a></span><span class="md-toc-item md-toc-h6" data-ref="n271"><a class="md-toc-inner" href="#header-n271">Mapper - 批量的CRUD接口:</a></span><span class="md-toc-item md-toc-h6" data-ref="n277"><a class="md-toc-inner" href="#header-n277">Mapper - 选装组件:</a></span><span class="md-toc-item md-toc-h6" data-ref="n308"><a class="md-toc-inner" href="#header-n308">Service - CRUD:</a></span><span class="md-toc-item md-toc-h3" data-ref="n311"><a class="md-toc-inner" href="#header-n311">核心三 - 强大之 -Wrapper条件构造器</a></span><span class="md-toc-item md-toc-h4" data-ref="n312"><a class="md-toc-inner" href="#header-n312">Demo代码地址：</a></span><span class="md-toc-item md-toc-h4" data-ref="n314"><a class="md-toc-inner" href="#header-n314">工程: </a></span><span class="md-toc-item md-toc-h5" data-ref="n315"><a class="md-toc-inner" href="#header-n315">第一 --&gt;第四步 同上一工程步骤  </a></span><span class="md-toc-item md-toc-h5" data-ref="n322"><a class="md-toc-inner" href="#header-n322">第五步、探索Wrapper</a></span><span class="md-toc-item md-toc-h6" data-ref="n324"><a class="md-toc-inner" href="#header-n324">Wrapper含义: </a></span><span class="md-toc-item md-toc-h6" data-ref="n326"><a class="md-toc-inner" href="#header-n326">版本不同:</a></span><span class="md-toc-item md-toc-h6" data-ref="n343"><a class="md-toc-inner" href="#header-n343">3.x Wrapper主要继承结构: </a></span><span class="md-toc-item md-toc-h6" data-ref="n348"><a class="md-toc-inner" href="#header-n348">AbstractWrapper接口:</a></span><span class="md-toc-item md-toc-h6" data-ref="n350"><a class="md-toc-inner" href="#header-n350">AbstractWrapper接口:</a></span><span class="md-toc-item md-toc-h6" data-ref="n352"><a class="md-toc-inner" href="#header-n352">UpdateWrapper接口:</a></span><span class="md-toc-item md-toc-h5" data-ref="n355"><a class="md-toc-inner" href="#header-n355">第六步、使用接口</a></span><span class="md-toc-item md-toc-h6" data-ref="n356"><a class="md-toc-inner" href="#header-n356"><strong>##打印SQL日志配置</strong></a></span><span class="md-toc-item md-toc-h6" data-ref="n359"><a class="md-toc-inner" href="#header-n359">一&gt; 编写AbstractWrapper测试类:</a></span><span class="md-toc-item md-toc-h5" data-ref="n362"><a class="md-toc-inner" href="#header-n362"><strong>发现问题</strong>: <code>boolean condition</code> 、<code> R column</code>和 <code>Function&lt;This, This&gt; func</code> 三个参数相关问题</a></span><span class="md-toc-item md-toc-h6" data-ref="n363"><a class="md-toc-inner" href="#header-n363">说明及使用:</a></span><span class="md-toc-item md-toc-h6" data-ref="n365"><a class="md-toc-inner" href="#header-n365">1.关于入参: <code>boolean condition</code> </a></span><span class="md-toc-item md-toc-h6" data-ref="n378"><a class="md-toc-inner" href="#header-n378">2.关于入参: <code>R column</code> </a></span><span class="md-toc-item md-toc-h6" data-ref="n404"><a class="md-toc-inner" href="#header-n404">3.关于入参: <code>Function&lt;This, This&gt; func</code> </a></span><span class="md-toc-item md-toc-h6" data-ref="n425"><a class="md-toc-inner" href="#header-n425">二&gt; 编写QueryWrapper与UpdateWrapper测试类:</a></span><span class="md-toc-item md-toc-h5" data-ref="n429"><a class="md-toc-inner" href="#header-n429"><strong>注意坑</strong>  在借用 <code>lambda()</code> 使用 lambda特性时!</a></span><span class="md-toc-item md-toc-h2" data-ref="n433"><a class="md-toc-inner" href="#header-n433">六、插件及扩展 </a></span><span class="md-toc-item md-toc-h3" data-ref="n434"><a class="md-toc-inner" href="#header-n434">Demo代码地址：</a></span><span class="md-toc-item md-toc-h3" data-ref="n439"><a class="md-toc-inner" href="#header-n439">工程：</a></span><span class="md-toc-item md-toc-h4" data-ref="n440"><a class="md-toc-inner" href="#header-n440">第一 --&gt;第四步、同上</a></span><span class="md-toc-item md-toc-h4" data-ref="n442"><a class="md-toc-inner" href="#header-n442">第五步、插件使用</a></span><span class="md-toc-item md-toc-h5" data-ref="n443"><a class="md-toc-inner" href="#header-n443">分页插件:</a></span><span class="md-toc-item md-toc-h6" data-ref="n445"><a class="md-toc-inner" href="#header-n445">1、创建一个MP插件的配置类:</a></span><span class="md-toc-item md-toc-h6" data-ref="n448"><a class="md-toc-inner" href="#header-n448">2、配置分页插件</a></span><span class="md-toc-item md-toc-h6" data-ref="n450"><a class="md-toc-inner" href="#header-n450">3、编写测试</a></span><span class="md-toc-item md-toc-h5" data-ref="n453"><a class="md-toc-inner" href="#header-n453">逻辑删除插件:</a></span><span class="md-toc-item md-toc-h6" data-ref="n454"><a class="md-toc-inner" href="#header-n454">1、yaml添加逻辑值制定配置：</a></span><span class="md-toc-item md-toc-h6" data-ref="n456"><a class="md-toc-inner" href="#header-n456">2、配置逻辑插件:</a></span><span class="md-toc-item md-toc-h6" data-ref="n459"><a class="md-toc-inner" href="#header-n459">3、标识逻辑字段:</a></span><span class="md-toc-item md-toc-h6" data-ref="n462"><a class="md-toc-inner" href="#header-n462">4、编写测试</a></span><span class="md-toc-item md-toc-h5" data-ref="n465"><a class="md-toc-inner" href="#header-n465">乐观锁:</a></span><span class="md-toc-item md-toc-h6" data-ref="n466"><a class="md-toc-inner" href="#header-n466">主要适用场景</a></span><span class="md-toc-item md-toc-h2" data-ref="n498"><a class="md-toc-inner" href="#header-n498">七 、总结</a></span><span class="md-toc-item md-toc-h2" data-ref="n510"><a class="md-toc-inner" href="#header-n510">参考文档：</a></span></p></div><h2><a name='header-n22' class='md-header-anchor '></a>一、简单介绍</h2><p><img src='https://mp.baomidou.com/img/logo.png' alt='mybatis-plus图像' referrerPolicy='no-referrer' /></p><h3><a name='header-n24' class='md-header-anchor '></a>官方说明 ：</h3><p>Mybatis-Plus（简称MP）是一个Mybatis的增强工具，在 Mybatis 的基础上只做增强不做改变，为简化开发而生！</p><ul><li><h4><a name='header-n28' class='md-header-anchor '></a>润物无声</h4><p>只做增强不做改变，引入它不会对现有工程产生影响。</p></li><li><h4><a name='header-n31' class='md-header-anchor '></a>效率至上</h4><p>只需简单配置，即可快速进行 CRUD 操作，从而节省大量时间。</p></li><li><h4><a name='header-n34' class='md-header-anchor '></a>丰富功能</h4><p>热加载、代码生成、分页、性能分析等功能一应俱全。</p></li></ul><h3><a name='header-n36' class='md-header-anchor '></a>成绩：</h3><p>MyBatis-Plus 荣获<a href='https://www.oschina.net/question/2896879_2290300'>【2018年度开源中国最受欢迎的中国软件】</a> TOP5 <span>	</span>​<span>	</span></p><h3><a name='header-n38' class='md-header-anchor '></a>最新版本：</h3><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="xml" contenteditable="false" cid="n39" mdtype="fences">&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus&lt;/artifactId&gt;
    &lt;version&gt;3.0.7.1&lt;/version&gt;
&lt;/dependency&gt;
</pre><h3><a name='header-n40' class='md-header-anchor '></a>开发层面MyBatis-Plus特色</h3><ol start='' ><li><strong>代码生成</strong></li><li><strong>条件构造器</strong></li></ol><h3><a name='header-n46' class='md-header-anchor '></a>Mybatis-Plus中的Plus</h3><p><img src='https://mp.baomidou.com/img/relationship-with-mybatis.png' alt='like' referrerPolicy='no-referrer' />官方简介说明 MP 和Mybatis 就像是 游戏中的p1 和p2 一样 兄弟搭配 干活不累 、</p><p>我在使用中明显感觉到 其实他更像是 马里奥和蘑菇  吃了蘑菇 我们跳的高度更高了一些。</p><h2><a name='header-n49' class='md-header-anchor '></a>二、MP的特性</h2><ul><li><strong>无侵入</strong>：只做增强不做改变，引入它不会对现有工程产生影响，如丝般顺滑</li><li><strong>损耗小</strong>：启动即会自动注入基本 CURD，性能基本无损耗，直接面向对象操作</li><li><strong>强大的 CRUD 操作</strong>：内置通用 Mapper、通用 Service，仅仅通过少量配置即可实现单表大部分 CRUD 操作，更有强大的条件构造器，满足各类使用需求</li><li><strong>支持 Lambda 形式调用</strong>：通过 Lambda 表达式，方便的编写各类查询条件，无需再担心字段写错</li><li><strong>内置代码生成器</strong>：采用代码或者 Maven 插件可快速生成 Mapper 、 Model 、 <strong>Service 、 Controller</strong> 层代码，支持模板引擎，更有超多自定义配置等您来使用</li><li><strong>内置分页插件</strong>：基于 MyBatis 物理分页，开发者无需关心具体操作，配置好插件之后，写分页等同于普通 List 查询</li><li><strong>内置全局拦截插件</strong>：提供全表 delete 、 update 操作智能分析阻断，也可自定义拦截规则，预防误操作</li><li><strong>支持多种数据库</strong>：支持 MySQL、MariaDB、Oracle、DB2、H2、HSQL、SQLite、Postgre、SQLServer2005、SQLServer 等多种数据库</li><li><strong>支持主键自动生成</strong>：支持多达 4 种主键策略（<code>内含分布式唯一 ID 生成器 - Sequence</code>），可自由配置，完美解决主键问题</li><li><strong>支持 XML 热加载</strong>：<u>Mapper 对应的 XML 支持热加载，对于简单的 CRUD 操作</u>，甚至可以无 XML 启动</li><li><strong>支持 ActiveRecord 模式</strong>：支持 ActiveRecord 形式调用，实体类只需继承 Model 类即可进行强大的 CRUD 操作</li><li><strong>支持自定义全局通用操作</strong>：支持全局通用方法注入（ Write once, use anywhere ）</li><li><strong>支持关键词自动转义</strong>：支持数据库关键词（order、key......）自动转义，还可自定义关键词</li><li><strong>内置性能分析插件</strong>：可输出 Sql 语句以及其执行时间，建议开发测试时启用该功能，能快速揪出慢查询</li><li><strong>内置 Sql 注入剥离器</strong>：支持 Sql 注入剥离，有效预防 Sql 注入攻击</li></ul><h2><a name='header-n81' class='md-header-anchor '></a>三、MP框架结构</h2><p><img src='https://mp.baomidou.com/img/mybatis-plus-framework.jpg' alt='框架' referrerPolicy='no-referrer' /></p><p>&nbsp;</p><p>&nbsp;</p><h2><a name='header-n85' class='md-header-anchor '></a>四、简单的入门Demo(Mysql)</h2><h4><a name='header-n86' class='md-header-anchor '></a>Demo代码地址：</h4><p><a href='https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo</a></p><h4><a name='header-n88' class='md-header-anchor '></a>Demo 环境： </h4><p><span>	</span>windows 7</p><p><span>	</span>jdk 1.8.0.40</p><p><span>	</span>idea Ultimate </p><p><span>	</span>maven 3.3.9<span>	</span></p><h4><a name='header-n93' class='md-header-anchor '></a>初始化：</h4><h5><a name='header-n94' class='md-header-anchor '></a>数据库：MySql</h5><p>创建数据库<code>mp_demo_db</code>设置字符集 utf-8</p><h6><a name='header-n96' class='md-header-anchor '></a>DDL:</h6><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="sql" contenteditable="false" cid="n97" mdtype="fences">-- 创建简单表格
DROP TABLE IF EXISTS user;

CREATE TABLE `user` (
  `id` bigint(20) PRIMARY KEY AUTO_INCREMENT  COMMENT '主键ID',
  `name` varchar(30) DEFAULT NULL COMMENT '姓名',
  `age` int(11) DEFAULT NULL COMMENT '年龄',
  `email` varchar(50) DEFAULT NULL COMMENT '邮箱'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


</pre><h6><a name='header-n98' class='md-header-anchor '></a>DML:</h6><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="sql" contenteditable="false" cid="n99" mdtype="fences">-- 初始化数据
DELETE FROM user;

INSERT INTO user (id, name, age, email) VALUES
(1, 'Jone', 18, 'test1@baomidou.com'),
(2, 'Jack', 20, 'test2@baomidou.com'),
(3, 'Tom', 28, 'test3@baomidou.com'),
(4, 'Sandy', 21, 'test4@baomidou.com'),
(5, 'Billie', 24, 'test5@baomidou.com');
</pre><h4><a name='header-n100' class='md-header-anchor '></a>工程：</h4><p><span>	</span>为了方便快捷 选用 SpringBoot 工程作为Demo支撑</p><h5><a name='header-n102' class='md-header-anchor '></a>第一步、创建工程</h5><p><img src='assets/1546839886488.png' alt='1546839886488' referrerPolicy='no-referrer' /></p><p>输入项目包名 并<strong>添加mysql模块</strong> 创建完毕。</p><h5><a name='header-n105' class='md-header-anchor '></a>第二步、引入依赖坐标</h5><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="xml" contenteditable="false" cid="n106" mdtype="fences" style="break-inside: unset;"> &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;3.0.7.1&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!--手动添加模板引擎--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.freemarker&lt;/groupId&gt;
            &lt;artifactId&gt;freemarker&lt;/artifactId&gt;
            &lt;version&gt;2.3.20&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;
            &lt;version&gt;3.0.6&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-core&lt;/artifactId&gt;
            &lt;version&gt;3.0.7.1&lt;/version&gt;
        &lt;/dependency&gt;
</pre><h5><a name='header-n107' class='md-header-anchor '></a>第三步、配置数据源</h5><p>在 <code>application.yml</code> 配置文件中添加相关配置：</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="yaml" contenteditable="false" cid="n109" mdtype="fences"># DataSource Config
spring:
  datasource:
    # 这里如果有错误是因为 maven mysql包 选择了 runtime 形式的 scope  可以不用管它 继续下一步就好
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf8
    username: root
    password: 123456
</pre><h5><a name='header-n110' class='md-header-anchor '></a>第四步、添加mybatis扫描位置</h5><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n111" mdtype="fences">@SpringBootApplication
@MapperScan("com.lynwood.mp.simpledemo.mapper")
public class SimpledemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(SimpledemoApplication.class, args);
    }

}
</pre><h5><a name='header-n112' class='md-header-anchor '></a>第五步、pojo及mapper</h5><p>pojo:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n114" mdtype="fences">import lombok.Data;

@Data
public class User {
    private Long id;
    private String name;
    private Integer age;
    private String email;
}
</pre><p>mapper:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n116" mdtype="fences">import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import com.lynwood.mp.simpledemo.model.User;

public interface UserMapper extends BaseMapper&lt;User&gt; {

}
</pre><h5><a name='header-n117' class='md-header-anchor '></a>第六步、测试</h5><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n118" mdtype="fences" style="break-inside: unset;">@RunWith(SpringRunner.class)
@SpringBootTest
public class SampleTest {

    @Autowired
    private UserMapper userMapper;

    @Test
    public void testSelect() {
        List&lt;User&gt; userList = userMapper.selectList(null);
        Assert.assertEquals(5, userList.size());
        userList.forEach(System.out::println);
    }

}
</pre><p>运行结果：</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n120" mdtype="fences">User{id=1, name='Jone', age=18, email='test1@baomidou.com'}
User{id=2, name='Jack', age=20, email='test2@baomidou.com'}
User{id=3, name='Tom', age=28, email='test3@baomidou.com'}
User{id=4, name='Sandy', age=21,email='test4@baomidou.com'}
User{id=5, name='Bill', age=24,email='test5@baomidou.com'}
</pre><h2><a name='header-n121' class='md-header-anchor '></a>五、核心功能</h2><h3><a name='header-n122' class='md-header-anchor '></a>核心一-简便之-代码生成器（AutoGenerator）</h3><p><span>	</span>AutoGenerator 是 MyBatis-Plus 的代码生成器，通过 AutoGenerator 可以快速生成 Entity、Mapper、Mapper XML、Service、Controller 等各个模块的代码，极大的提升了开发效率。</p><h4><a name='header-n124' class='md-header-anchor '></a>Demo代码地址：</h4><p><a href='https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/simpledemo</a></p><h4><a name='header-n126' class='md-header-anchor '></a>Demo 环境： </h4><p><span>	</span>同上</p><h4><a name='header-n128' class='md-header-anchor '></a>工程：</h4><p><span>	</span></p><h5><a name='header-n130' class='md-header-anchor '></a>第一步、创建模块</h5><p><span>	</span>创建了autogenerator_demo模块（记得<strong>添加mysql模块</strong> ）作为演示代码生成器功能配置。</p><h5><a name='header-n132' class='md-header-anchor '></a>第二步、引入依赖坐标</h5><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="xml" contenteditable="false" cid="n133" mdtype="fences" style="break-inside: unset;">&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;3.0.7.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;!--手动添加模板引擎--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;
    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.3.20&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;
    &lt;version&gt;3.0.6&lt;/version&gt;
&lt;/dependency&gt;
</pre><p><strong>注意</strong>：MP <code>3.0.3</code> 之后移除了自动模板引擎依赖，需要<strong>手动添加</strong>对应<strong>模板引擎</strong></p><h5><a name='header-n135' class='md-header-anchor '></a>第三步、编写代码生成器</h5><p><span>	</span>直接复制就行啦！</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n137" mdtype="fences" style="break-inside: unset;">package com.lynwood.mp.autogenerator_demo;

import com.baomidou.mybatisplus.core.exceptions.MybatisPlusException;
import com.baomidou.mybatisplus.core.toolkit.StringPool;
import com.baomidou.mybatisplus.core.toolkit.StringUtils;
import com.baomidou.mybatisplus.generator.AutoGenerator;
import com.baomidou.mybatisplus.generator.InjectionConfig;
import com.baomidou.mybatisplus.generator.config.*;
import com.baomidou.mybatisplus.generator.config.po.TableInfo;
import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;
import com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine;

import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

//注意引入GlobalConfig 使用 import com.baomidou.mybatisplus.generator.config.*;

public class GeneratorCode {
    /**
     * 读取控制台内容
     */
    public static String scanner(String tip) {
        Scanner scanner = new Scanner(System.in);
        StringBuilder help = new StringBuilder();
        help.append("请输入" + tip + "：");
        System.out.println(help.toString());
        if (scanner.hasNext()) {
            String ipt = scanner.next();
            if (StringUtils.isNotEmpty(ipt)) {
                return ipt;
            }
        }
        throw new MybatisPlusException("请输入正确的" + tip + "！");
    }

    public static void main(String[] args) {
        // 代码生成器
        AutoGenerator mpg = new AutoGenerator();

        // 全局配置
        GlobalConfig gc = new GlobalConfig();
        String projectPath = System.getProperty("user.dir");
        gc.setOutputDir(projectPath + "/src/main/java");
        gc.setAuthor("Lynwood");
        gc.setOpen(false);
        mpg.setGlobalConfig(gc);

        // 数据源配置
        DataSourceConfig dsc = new DataSourceConfig();
        dsc.setUrl("jdbc:mysql://127.0.0.1:3306/mp_demo_db?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8");
        // dsc.setSchemaName("public");
        dsc.setDriverName("com.mysql.jdbc.Driver");
        dsc.setUsername("root");
        dsc.setPassword("123456");
        mpg.setDataSource(dsc);

        // 包配置
        PackageConfig pc = new PackageConfig();
        pc.setModuleName(scanner("模块名"));
        pc.setParent("com.lynwood.mp.autogenerator_demo");
        mpg.setPackageInfo(pc);

        // 自定义配置
        InjectionConfig cfg = new InjectionConfig() {
            @Override
            public void initMap() {
                // to do nothing
            }
        };

        // 如果模板引擎是 freemarker
        String templatePath = "/templates/mapper.xml.ftl";
        // 如果模板引擎是 velocity
        // String templatePath = "/templates/mapper.xml.vm";

        // 自定义输出配置
        List&lt;FileOutConfig&gt; focList = new ArrayList&lt;&gt;();
        // 自定义配置会被优先输出
        focList.add(new FileOutConfig(templatePath) {
            @Override
            public String outputFile(TableInfo tableInfo) {
                // 自定义输出文件名
                return projectPath + "/src/main/resources/mapper/" + pc.getModuleName()
                        + "/" + tableInfo.getEntityName() + "Mapper" + StringPool.DOT_XML;
            }
        });

        cfg.setFileOutConfigList(focList);
        mpg.setCfg(cfg);

        // 配置模板
        TemplateConfig templateConfig = new TemplateConfig();

        // 配置自定义输出模板
        // templateConfig.setEntity();
        // templateConfig.setService();
        // templateConfig.setController();

        templateConfig.setXml(null);
        mpg.setTemplate(templateConfig);

        // 策略配置
        StrategyConfig strategy = new StrategyConfig();
        strategy.setNaming(NamingStrategy.underline_to_camel);
        strategy.setColumnNaming(NamingStrategy.underline_to_camel);
        strategy.setSuperEntityClass(null);
        strategy.setEntityLombokModel(true);
        strategy.setRestControllerStyle(true);
        strategy.setSuperControllerClass(null);
        strategy.setInclude(scanner("表名"));
        strategy.setSuperEntityColumns(null);
        strategy.setControllerMappingHyphenStyle(true);
        strategy.setTablePrefix(pc.getModuleName() + "_");
        mpg.setStrategy(strategy);
        mpg.setTemplateEngine(new FreemarkerTemplateEngine());
        mpg.execute();
    }

}

</pre><h5><a name='header-n138' class='md-header-anchor '></a>第四步、运行测试</h5><p><img src='assets/1546926876784.png' alt='1546926876784' referrerPolicy='no-referrer' /></p><p>&nbsp;</p><p>在控制台输入：</p><p><img src='assets/1546926951091.png' alt='1546926951091' referrerPolicy='no-referrer' /></p><p>就可以生成代码啦！  </p><p>都包含 ：</p><p><img src='assets/1546927063917.png' alt='1546927063917' referrerPolicy='no-referrer' /></p><h5><a name='header-n146' class='md-header-anchor '></a><strong>发现问题</strong>： 如果是多模块项目 生成的文件会直接到了父项目目录下</h5><p><span>	</span>原因是：在代码的全局配置中 <code>String projectPath = System.getProperty(&quot;user.dir&quot;);</code> 获取<strong>Working Directory</strong>时 返回的是项目路径，并非模块路径！</p><h6><a name='header-n148' class='md-header-anchor '></a>解决方法：</h6><p><span>	</span>我们可以设定运行参数选项</p><p><img src='assets/1546927538730.png' alt='1546927538730' referrerPolicy='no-referrer' /></p><p>&nbsp;</p><p>将 <strong>Working Directory</strong> 调整为 <strong><u>当前模块目录</u></strong> 再次运行就ok了！</p><p>&nbsp;</p><ul><li>因为没有引入mvc 模块 以至于@Controller 会飘红  再Demo中就没有将生成代码传入  大可拉取代码本地使用！</li><li>相关代码生成器的配置：<a href='https://mybatis.plus/config/generator-config.html'>官方生成器配置</a> 可配置项过多无法详细介绍 有相关使用会提及</li></ul><h3><a name='header-n159' class='md-header-anchor '></a>核心二 - 清晰之-CRUD接口</h3><h4><a name='header-n160' class='md-header-anchor '></a>Demo代码地址：</h4><p><a href='https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_crud_demo' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_crud_demo</a></p><p>&nbsp;</p><p><span>	</span>Mybatis-Plus 为我们提供了丰富的 增删改查接口 </p><p><span>	</span>我们可以分为三类 <strong>Mapper的CRUD接口</strong>、<strong>Service的CRUD接口</strong>和<strong>mapper层选装件接口</strong>：</p><p><img src='assets/1546932099260.png' alt='1546932099260' referrerPolicy='no-referrer' /></p><p><span>	</span>确实比较丰富 ， 下面会以具有代表性的例子来使用 演示 作为Demo主要内容</p><h4><a name='header-n167' class='md-header-anchor '></a>工程：</h4><h5><a name='header-n168' class='md-header-anchor '></a>第一步、创建模块</h5><p><span>	</span>创建mp_crud_demo模块 选择mysql </p><h5><a name='header-n170' class='md-header-anchor '></a>第二步、引入依赖坐标</h5><p><span>	</span>因为需要生成表对应Pojo 还需要代码生成器  </p><p><span>	</span>然后我们将上面的直接拷贝一下 </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="xml" contenteditable="false" cid="n173" mdtype="fences" style="break-inside: unset;">&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;3.0.7.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;!--手动添加模板引擎--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;
    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.3.20&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;
    &lt;version&gt;3.0.6&lt;/version&gt;
&lt;/dependency&gt;
</pre><p><span>	</span>再添加 lombok 依赖(因：生成代码中的实体默认是使用@Data 等注解的)</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="xml" contenteditable="false" cid="n175" mdtype="fences"> &lt;dependency&gt;
     &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
     &lt;artifactId&gt;lombok&lt;/artifactId&gt;
     &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;
</pre><h5><a name='header-n176' class='md-header-anchor '></a>第三步、生成代码</h5><ul><li><strong>复制</strong>上一Demo<u>模块生成器</u><strong>代码</strong></li><li><strong>更改模块名</strong>称使之对应 <code>pc.setParent(&quot;com.lynwood.mp.mp_crud_demo&quot;);</code></li><li><strong>设置Working Directory</strong> 为<strong>当前模块</strong> 防止文件输出位置错误</li><li>运行<strong>获取代码</strong></li><li><strong>删除</strong>不必要用到的<strong>controller层</strong></li></ul><h5><a name='header-n188' class='md-header-anchor '></a>第四步、其他配置需要</h5><ul><li><p>设定mybatis扫描位置</p><p>在<code>MpCrudDemoApplication</code> 上<strong>添加注解</strong>：<code>@MapperScan(&quot;com.lynwood.mp.mp_crud_demo.*.mapper**&quot;)</code></p><p><strong>注意 扫描包的位置</strong>！</p></li><li><p><strong>配置数据源</strong>：</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="yaml" contenteditable="false" cid="n196" mdtype="fences"># DataSource Config
spring:
  datasource:
  # 这里如果有错误是因为 maven mysql包 选择了 runtime 形式的 scope  可以不用管它 继续下一步就好
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf-8
    username: root
    password: 123456
</pre></li></ul><h5><a name='header-n197' class='md-header-anchor '></a>第五步、对MP探个究竟！</h5><p><span>	</span><u><strong>以<code>userMapper</code>作为范例</strong></u></p><ul><li><p>查看<code>UserMapper</code>:</p><p>打开<code>UserMapper.java</code>源代码:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n203" mdtype="fences">public interface UserMapper extends BaseMapper&lt;User&gt; {
}

</pre><p>不难发现它<strong>继承了</strong><code>BaseMapper&lt;User&gt;</code> 接口 </p><p>打开<code>com.baomidou.mybatisplus.core.mapper.BaseMapper&lt;T&gt;</code> </p><p>查看当前接口的结构(Structure): </p><p><img src='assets/1547002387987.png' alt='1547002387987' referrerPolicy='no-referrer' /></p><p><strong>原来</strong>是MP 将之前的mybatis里面<strong>每个mapper的所有方法</strong> 经过<strong>泛型</strong>进行提炼到了一个BaseMapper 接口中,我们<strong>只需要将自己的mapper 继承此接口且将泛型指定便可获得强大的CRUD功能</strong>!</p></li><li><p>再去查看<code>UserMapper.xml</code> 文件 :</p></li></ul><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n211" mdtype="fences">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;mapper namespace="com.lynwood.mp.mp_crud_demo.business.mapper.UserMapper"&gt;

&lt;/mapper&gt;
</pre><p><span>	</span><strong>完全丢弃了<code>Mybatis</code>中字段映射以及一段段复杂的配置!</strong></p><hr /><h5><a name='header-n214' class='md-header-anchor '></a><strong>发现问题</strong>:  我虽然看到了方法 但是并没有一条SQL 那么它是怎样做到查询的呢?</h5><h6><a name='header-n215' class='md-header-anchor '></a>探索:</h6><ul><li><strong><em>首先</em></strong> 在项目搭建的时候添加了 坐标:</li></ul><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="xml" contenteditable="false" cid="n219" mdtype="fences">       &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;3.0.7.1&lt;/version&gt;
        &lt;/dependency&gt;
</pre><p>我们进入<code>mybatis-plus-boot-starter</code>的pom 发现他帮我们装配了对应版本的<code>mybatis-plus</code> 并且依赖了其他 例如: <code>spring-boot-autoconfigure``spring-boot-starter-jdbc</code>等;</p><p>因为<strong>了解</strong><code>SpringBoot</code>中<strong>配置入口</strong>是一个<code>@Configuration</code> </p><p>那么<strong>打开</strong><code>mybatis-plus-boot-starter</code>的<code>jar</code>包 <strong>看到</strong>:<code>MybatisPlusAutoConfiguration.java</code>:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n223" mdtype="fences" style="break-inside: unset;">...
public class MybatisPlusAutoConfiguration {
 ...
    @Bean
    @ConditionalOnMissingBean
    public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {
     ...
         
        if (this.applicationContext.getBeanNamesForType(ISqlInjector.class, false, false).length &gt; 0) {
            ISqlInjector iSqlInjector = (ISqlInjector)this.applicationContext.getBean(ISqlInjector.class);
            globalConfig.setSqlInjector(iSqlInjector);
        }

        factory.setGlobalConfig(globalConfig);
        return factory.getObject();
 }
...
}
</pre><p>看到它在设置<code>sqlSessionFactory</code>的时候为我们<strong>指定</strong>了一个<code>com.baomidou.mybatisplus.core.injector.ISqlInjector.class</code> <strong>作为</strong><code>factory.globalConfig.sqlInjector</code>(<strong>SQL注入器</strong>)</p><p> <strong><em>然后</em></strong> 我们打开:<code>ISqlInjector</code>的实现类<code>AbstractSqlInjector</code></p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n226" mdtype="fences" style="break-inside: unset;">...
    public abstract class AbstractSqlInjector implements ISqlInjector {
        ...
            public void inspectInject(MapperBuilderAssistant builderAssistant, Class&lt;?&gt; mapperClass) {
            ...
            List&lt;AbstractMethod&gt; methodList = this.getMethodList();
            Assert.notEmpty(methodList, "No effective injection method was found.", new Object[0]);
       
            methodList.forEach((m) -&gt; {
                m.inject(builderAssistant, mapperClass);
            });
            ...
        }
    }
</pre><p><code>methodList</code> 是所有的方法的一个集合 其<strong>元素类型</strong>都是<code>AbstractMethod.class</code>类型的, 并且对<strong>每个方法都进行了</strong><code>inject(...)</code>,</p><p>那么查看<code>inject()</code>方法源码:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n229" mdtype="fences">public void inject(MapperBuilderAssistant builderAssistant, Class&lt;?&gt; mapperClass) {
   ...
        this.injectMappedStatement(mapperClass, modelClass, tableInfo);
    }
}
</pre><p><strong>原来最终调用</strong>了<code>injectMappedStatement()</code>方法   </p><p><strong>然而</strong> </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n232" mdtype="fences">public abstract MappedStatement injectMappedStatement(Class&lt;?&gt; var1, Class&lt;?&gt; var2, TableInfo var3);
</pre><p>是<strong>抽象的</strong> 需要自己的子类<strong>去实现</strong>的  </p><p><img src='assets/1547011199397.png' alt='1547011199397' referrerPolicy='no-referrer' /></p><p>我们<strong>以</strong>其中一个 <code>SelectById.class</code>  作为<strong>例子</strong>查看</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n236" mdtype="fences">  public MappedStatement injectMappedStatement(Class&lt;?&gt; mapperClass, Class&lt;?&gt; modelClass, TableInfo tableInfo) {
        SqlMethod sqlMethod = SqlMethod.SELECT_BY_ID;
        SqlSource sqlSource = new RawSqlSource(this.configuration, String.format(sqlMethod.getSql(), this.sqlSelectColumns(tableInfo, false), tableInfo.getTableName(), tableInfo.getKeyColumn(), tableInfo.getKeyProperty()), Object.class);
        return this.addSelectMappedStatement(mapperClass, sqlMethod.getMethod(), sqlSource, modelClass, tableInfo);
    }

</pre><p><strong>再去查看</strong> <code>SqlMethod.SELECT_BY_ID;</code>: </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n238" mdtype="fences">SELECT_BY_ID("selectById", "根据ID 查询一条数据", "SELECT %s FROM %s WHERE %s=#{ %s}"),
</pre><p><em>soga~</em></p><p><strong><em>结束</em></strong> 最后实际上 MP将SQL语句 封装了<strong>固定的模板</strong> <code>com.baomidou.mybatisplus.core.enums.SqlMethod</code> 从而提供给了我们便捷的使用!</p><h5><a name='header-n241' class='md-header-anchor '></a>第六步、使用它</h5><p><span>	</span>我们使用<strong>非Wrapper</strong>的具有代表性的接口作为Demo的演示</p><p><span>	</span>Wrapper 在后面会有单独的Demo演示</p><p>&nbsp;</p><h6><a name='header-n245' class='md-header-anchor '></a>Mapper - 简单的CRUD:</h6><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n246" mdtype="fences" style="break-inside: unset;">@RunWith(SpringRunner.class)
@SpringBootTest
public class MpCrudDemoApplicationTests {

    @Autowired
    private UserMapper userMapper;

    @Test
    public void simplenessMapperCURD() {
        //增加
        User addUser = new User();
        addUser.setAge(18);
        addUser.setEmail("wunian_@hotmail.com");
        addUser.setName("Lynwood");
        userMapper.insert(addUser); // insert 之后是将id装配到实体对象里的
        System.out.println("add:\n" + addUser);
        // User(id=1082883152404103169, name=Lynwood, age=18, email=wunian_@hotmail.com)
        // id = 1082883152404103169  之所以这么长是因为  MP底层给我们自己以uuid 的形式添加了 user对象的id属性

        //修改
        User updateUser = new User();
        updateUser.setId(1082883152404103169L);
        updateUser.setName("ok?");
        userMapper.updateById(updateUser);
        System.out.println("update:\n" + updateUser);
        //  User(id=1082883152404103169, name=ok?, age=null, email=null)
        // 刷新数据库 更改成功 但是没有讲其他对象进行装配

        //查询
        User selectUser = userMapper.selectById(1082883152404103169L);
        System.out.println("select:\n" + selectUser);
        //User(id=1082883152404103169, name=ok?, age=18, email=wunian_@hotmail.com)

        //删除
        int i = userMapper.deleteById(1082883152404103169L);
        if (i==1){
            System.out.println("delete:\n" + "删除成功!");
            //刷新库 删除成功
        }
    }
}
</pre><h5><a name='header-n247' class='md-header-anchor '></a><strong>发现问题</strong>: 虽然MP替我生成了 uuid 作为主键,但是还是想用数据库自增形式主键怎么办?</h5><h6><a name='header-n248' class='md-header-anchor '></a>解决:</h6><p>MP提供的主键策略有:</p><ul><li>AUTO 数据库ID自增</li><li>INPUT 用户输入ID</li><li>ID_WORKER 全局唯一ID，Long类型的主键</li><li>ID_WORKER_STR 字符串全局唯一ID</li><li>UUID 全局唯一ID，UUID类型的主键</li><li>NONE 该类型为未设置主键类型</li></ul><p>MP的主键策略<strong>默认</strong>使用的是<code>ID_WORKER</code> (详情:<a href='https://mybatis.plus/config/#idtype' target='_blank' class='url'>https://mybatis.plus/config/#idtype</a>)</p><p>在User 中<strong>设定 id字段</strong>为<code>@TableId(type = IdType.AUTO)</code> </p><p>或者 <strong>全局设置 使用主键策略</strong>,在yaml 添加:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="yaml" contenteditable="false" cid="n266" mdtype="fences">mybatis-plus:
  global-config:
    db-config:
      id-type: auto
</pre><p><strong>重要</strong>:  <strong>因为刚才的测试插入了id为:<code>1082883152404103169</code>的 数据 我们需要将自增序列首先恢复正常! 否则下一个id为1082883152404103170 看上去也是乱的!!  小心坑哈~  </strong></p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="sql" contenteditable="false" cid="n268" mdtype="fences">delete from user;
alter table user auto_increment= 1;
</pre><p>尝试 增加操作  输出: </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="CQL" contenteditable="false" cid="n270" mdtype="fences">add:
User(id=1, name=Lynwood, age=18, email=wunian_@hotmail.com)
</pre><h6><a name='header-n271' class='md-header-anchor '></a>Mapper - 批量的CRUD接口:</h6><p><span>	</span>填充测试数据: </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="sql" contenteditable="false" cid="n273" mdtype="fences">DELETE FROM user;
INSERT INTO user ( name, age, email) VALUES
( 'Lynwood',18,'wunian_@hotmail.com')
( 'Jone', 18, 'test1@baomidou.com'),
( 'Jack', 20, 'test2@baomidou.com'),
( 'Tom', 28, 'test3@baomidou.com'),
( 'Sandy', 21, 'test4@baomidou.com'),
( 'Billie', 24, 'test5@baomidou.com');
</pre><p>测试:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n275" mdtype="fences" style="break-inside: unset;"> @Test
    public void batchMapperCURD() {
        // 多id 查询
        List&lt;Long&gt; idList = new ArrayList&lt;&gt;();
        idList.add(1L);
        idList.add(3L);
        List&lt;User&gt; userList = userMapper.selectBatchIds(idList);// id的多个查询
        System.out.println("selectBatch:" );
        userList.forEach(System.out::println);
        //User(id=1, name=Lynwood, age=18, email=wunian_@hotmail.com)
        //User(id=3, name=Jack, age=20, email=test2@baomidou.com)

        // 多条件  查询
        Map&lt;String,Object&gt; stringObjectMap = new HashMap&lt;&gt;();
        stringObjectMap.put("age",18);
        stringObjectMap.put("id",2);
        List&lt;User&gt; selectByMap = userMapper.selectByMap(stringObjectMap);// 字段-值 键值对集合 作为 '且' 关系
        System.out.println("selectByMap:" );
        selectByMap.forEach(System.out::println);
        //User(id=2, name=Jone, age=18, email=test1@baomidou.com)
        
        // 多id 删除
        int deleteCount = userMapper.deleteBatchIds(idList);// id的多个删除
        System.out.println("deleteBatch:\n"+ deleteCount );
        // 2
        
        // 多条件 删除
        int deleteCount2 = userMapper.deleteByMap(stringObjectMap);// id的多个查询
        System.out.println("deleteByMap:\n"+ deleteCount2 );
        // 1
    }
</pre><p><span>	</span>注意使用<code>*ByMap()</code> 方法时 条件是 <strong>且关系</strong>就ok了!</p><h6><a name='header-n277' class='md-header-anchor '></a>Mapper - 选装组件:</h6><p>查看了MP作者说的: </p><p><img src='assets/1547021955044.png' alt='1547021955044' referrerPolicy='no-referrer' /></p><p>中的 <strong><a href='https://gitee.com/baomidou/mybatis-plus-samples/tree/master/mybatis-plus-sample-sql-injector'>案例</a></strong> 以及 <strong><a href='https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-extension/src/main/java/com/baomidou/mybatisplus/extension/injector/methods/additional/InsertBatchSomeColumn.java'>源码注释</a></strong> 之后</p><p>作者在源码注释中是这么写的....:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n282" mdtype="fences" style="break-inside: unset;">/**
 * &lt;p&gt; 批量新增数据,自选字段 insert &lt;/p&gt;
 * &lt;p&gt; 不同的数据库支持度不一样!!!  只在 mysql 下测试过!!!  只在 mysql 下测试过!!!  只在 mysql 下测试过!!! &lt;/p&gt;
 * &lt;p&gt; 除了主键是 &lt;strong&gt; 数据库自增的未测试 &lt;/strong&gt; 外理论上都可以使用!!! &lt;/p&gt;
 * &lt;p&gt; 如果你使用自增有报错或主键值无法回写到entity,就不要跑来问为什么了,因为我也不知道!!! &lt;/p&gt;
 * &lt;p&gt;
 * 自己的通用 mapper 如下使用:
 * int insertBatchSomeColumn(List&lt;T&gt; entityList);
 *
 * &lt;li&gt; 注意1: 不要加任何注解 !! &lt;/li&gt;
 * &lt;li&gt; 注意2: 自选字段 insert !!,如果个别字段在 entity 里为 null 但是数据库中有配置默认值, insert 后数据库字段是为 null 而不是默认值 &lt;/li&gt;
 *
 * &lt;p&gt;
 * 常用的构造入参:
 * &lt;/p&gt;
 */
</pre><p>┓( ´∀` )┏  ~</p><p> 然后分析其作用  觉得既然有wrapper的强大条件构造器 决定不再分析  想了解可以点击:</p><p><strong><a href='https://gitee.com/baomidou/mybatis-plus/blob/3.0/mybatis-plus-extension/src/main/java/com/baomidou/mybatisplus/extension/injector/methods/additional/InsertBatchSomeColumn.java'>源码注释</a></strong></p><p>不过 <strong>案例</strong>  说明了MP的一些可以自己扩展的一个流程 :</p><ol start='' ><li><p>第一步: 在<code>UserMapper</code>添加方法</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n290" mdtype="fences">/** 清空表数据 */
void clearTable();
</pre></li><li><p>第二步:自定义实现</p><p>在于<code>business</code>同级下创建<code>mp_injector/methods</code>目录并创建<strong>类名</strong><code>CLearTable.java</code> <strong>要与</strong>添加的<strong>方法名</strong> <strong>相同!</strong> </p><p>且要实现<code>com.baomidou.mybatisplus.core.injector.AbstractMethod</code> 完成自定义扩展</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n295" mdtype="fences">public class ClearTable extends AbstractMethod {
    @Override
    public MappedStatement injectMappedStatement(Class&lt;?&gt; mapperClass, Class&lt;?&gt; modelClass, TableInfo tableInfo) {
        /* 执行 SQL */
        String sql = "delete from " + tableInfo.getTableName();
        /* mapper 接口方法名一致 */
        String method = "clearTable";
        SqlSource sqlSource = languageDriver.createSqlSource(configuration, sql, modelClass);
        return this.addDeleteMappedStatement(mapperClass, method, sqlSource);
    }
}

</pre></li><li><p>第三步:将自定义实现 添加到MP方法列表</p><p>在<code>mp_injector</code>下创建<code>MySqlInjector.java</code> 来进行对MP的<strong>扩展操作:</strong></p><p>需要继承<code>com.baomidou.mybatisplus.core.injector.DefaultSqlInjector</code> 并且重写 MP获取方法列表的方法</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n300" mdtype="fences">@Component
public class MySqlInjector extends DefaultSqlInjector {
    @Override
    public List&lt;AbstractMethod&gt; getMethodList() {
        List&lt;AbstractMethod&gt; methodList = super.getMethodList();
        //增加了 自定义方法
        methodList.add(new ClearTable());
        return methodList;
    }
}

</pre></li><li><p>第四步:测试</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n303" mdtype="fences">@Test
public void myInjectorMapperCURD() {
    userMapper.clearTable();
}
</pre><p>查库 全部删除了</p></li><li><p>总结: </p><p>不难发现其实际上就是 在上文 <a href='#%E7%AC%AC%E4%BA%94%E6%AD%A5%E5%AF%B9mp%E6%8E%A2%E4%B8%AA%E7%A9%B6%E7%AB%9F'> 对MP探个究竟</a> 中探索到的 所有方法的原理</p></li></ol><h6><a name='header-n308' class='md-header-anchor '></a>Service - CRUD:</h6><p><span>	</span>非Wrapper部分基本与Mapper 接口一致   只是将接口提到了service层.</p><p><span>	</span>略~</p><h3><a name='header-n311' class='md-header-anchor '></a>核心三 - 强大之 -Wrapper条件构造器</h3><h4><a name='header-n312' class='md-header-anchor '></a>Demo代码地址：</h4><p><a href='https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_wrapper_demo' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_wrapper_demo</a></p><h4><a name='header-n314' class='md-header-anchor '></a>工程: </h4><h5><a name='header-n315' class='md-header-anchor '></a>第一 --&gt;第四步 同上一工程步骤  </h5><ul><li>注意更改生成器中的 包名模块名</li><li>复制yaml 时注意增加 MP主键策略配置: </li></ul><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="yaml" contenteditable="false" cid="n321" mdtype="fences">mybatis-plus:
  global-config:
    db-config:
      id-type: auto
</pre><h5><a name='header-n322' class='md-header-anchor '></a>第五步、探索Wrapper</h5><p><span>	</span>备:关于 <strong>java8 lambda 表达式</strong> 默认为熟悉</p><h6><a name='header-n324' class='md-header-anchor '></a>Wrapper含义: </h6><p><span>	</span><img src='assets/1547101878214.png' alt='1547101878214' referrerPolicy='no-referrer' /></p><h6><a name='header-n326' class='md-header-anchor '></a>版本不同:</h6><p>因为MP 对外已经有了两个大的版本  2.x 和3.x版本</p><p>在2.x版本中 <code>EntityWrapper</code>作为Wrapper 的主要继承实现,</p><p>例:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n330" mdtype="fences"> EntityWrapper&lt;User&gt; ew = new EntityWrapper&lt;User&gt;();
    ew.setEntity(new User(1));
    ew.where("user_name={0}", "'zhangsan'").and("id=1")
            .orNew("user_status={0}", "0").or("status=1")
            .notLike("user_nickname", "notvalue")
            .andNew("new=xx").like("hhh", "ddd")
            .andNew("pwd=11").isNotNull("n1,n2").isNull("n3")
            .groupBy("x1").groupBy("x2,x3")
            .having("x1=11").having("x3=433")
            .orderBy("dd").orderBy("d1,d2");
    System.out.println(ew.getSqlSegment());

</pre><p>实际上 此包装实际上是<strong>使用的是 数据库字段</strong> 不是Pojo 里面的成员变量</p><p><strong>在3.x 升级中对Wrapper进行了改动</strong>:</p><ul><li><p>全面支持了jdk8的<strong>Lambda</strong>的使用</p></li><li><p><code>Wrapper&lt;T&gt;</code>实现类的改动</p><p>1.<code>EntityWrapper&lt;T&gt;</code>更名为<code>QueryWrapper&lt;T&gt;</code>
2.新增一个实现类<code>UpdateWrapper&lt;T&gt;</code>用于<code>update</code>方法</p></li><li><p><code>BaseMapper&lt;T&gt;</code>的改动</p><p>1.去除了<code>insertAllColumn(T entity)</code>方法
2.去除了<code>updateAllColumn(T entity)</code>方法
3.新增<code>update(T entity, Wrapper&lt;T&gt; updateWrapper)</code>方法</p></li></ul><p>在3.x 中将 所有的操作划分成 查询<code>QueryWrapper</code>和<code>UpdateWrapper</code> 并且将其共有的方法做了一层<strong>抽离</strong>放<strong>到</strong>了<code>AbstractWrapper</code><strong>中</strong></p><h6><a name='header-n343' class='md-header-anchor '></a>3.x Wrapper主要继承结构: </h6><p><img src='assets/1547103652530.png' alt='1547103652530' referrerPolicy='no-referrer' /></p><p>我们查看<strong>四个实现类</strong>:<code>QueryWrapper</code>、<code>UpdateWrapper</code> 、<code>LambdaQueryWrapper</code>、<code>LambdaUpdateWrapper</code> 的一个<strong>总体抽象</strong>: <code>AbstractWrapper</code></p><p>它将共有的提升到这一层并做了实现,</p><p><span>	</span><strong>其实主要是对SQL语言所有DML语句中公用的一些关键字做了统一的接口</strong></p><h6><a name='header-n348' class='md-header-anchor '></a>AbstractWrapper接口:</h6><p><img src='assets/1547104354429.png' alt='1547104354429' referrerPolicy='no-referrer' /></p><h6><a name='header-n350' class='md-header-anchor '></a>AbstractWrapper接口:</h6><p><img src='assets/1547104548508.png' alt='1547104548508' referrerPolicy='no-referrer' /></p><h6><a name='header-n352' class='md-header-anchor '></a>UpdateWrapper接口:</h6><p><img src='assets/1547104637008.png' alt='1547104637008' referrerPolicy='no-referrer' /></p><p>&nbsp;</p><h5><a name='header-n355' class='md-header-anchor '></a>第六步、使用接口</h5><h6><a name='header-n356' class='md-header-anchor '></a><strong>##打印SQL日志配置</strong></h6><p>为了方便查看最后MP封装转换的最终SQL，在yml配置文件中添加配置:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="yaml" contenteditable="false" cid="n358" mdtype="fences">mybatis-plus:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
</pre><h6><a name='header-n359' class='md-header-anchor '></a>一&gt; 编写AbstractWrapper测试类:</h6><p>Demo 中有  链接:<a href='https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperTests.java' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperTests.java</a></p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n361" mdtype="fences" style="break-inside: unset;">...
@RunWith(SpringRunner.class)
@SpringBootTest
public class MpWrapperDemoApplicationAbstractWrapperTests {
    @Autowired
    private UserMapper userMapper;

    /**
     *  测试 allEq()  等同于 WHERE name = ? AND age = ?
     *  +
     *  使用 selectList() 返回多个指定类型对象 的集合
     *
     */
    @Test
    public void abstractWrapperTest_allEq() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        HashMap&lt;String,Object&gt; param = new HashMap&lt;&gt;();
        param.put("name","Lynwood");
        param.put("age","18");
        userQueryWrapper.allEq(param);
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
         *    ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE name = ? AND age = ?
         *    ==&gt; Parameters: Lynwood(String), 18(String)
         */
    }

    /**
     *  测试 eq()  等同于 WHERE name = ?
     *  +
     *  使用selectOne()
     *      当返回多条会报错
     */
    @Test
    public void abstractWrapperTest_eq() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper.eq("name","Lynwood");
        User user = userMapper.selectOne(userQueryWrapper);
        System.out.println(user);
        /**
         * 输出:
         *           Preparing: SELECT id,name,age,email FROM user WHERE name = ?
         *           Parameters: Lynwood(String)
         */
    }

    /**     not equals 缩写 ~~
     *
     *  测试 ne()  等同于 WHERE age &lt;&gt; ?
     *  +
     *  使用 selectObjs() 返回多个 非指定类型对象 的集合
     *
     */
    @Test
    public void abstractWrapperTest_ne() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper.ne("age", 18);
        List&lt;Object&gt; objectList = userMapper.selectObjs(userQueryWrapper);
        objectList.forEach(System.out::println);
        /**
         * 输出:
         *    ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE age &lt;&gt; ?
         *      ==&gt; Parameters: 18(Integer)
         */
    }

    /***************************************************** 多接口连用 * 默认AND 关系*******************************/
    /**     测试
     *      gt() : greater than       等同于     &gt;
     *      ge() : greater equals     等同于     &gt;=
     *      lt() : less than          等同于     &lt;
     *      le() : less equals        等同于     &lt;=
     *
     *  使用 selectMaps() 返回多个 指定到Map做封装 的集合
     *
     */
    @Test
    public void abstractWrapperTest_gt_ge_lt_le() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper.ge("age", 21);
        userQueryWrapper.le("age", 24);
        List&lt;Map&lt;String, Object&gt;&gt; mapList = userMapper.selectMaps(userQueryWrapper);
        mapList.forEach(System.out::println);
        /**
         * 输出:
         *      ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE age &gt;= ? AND age &lt;= ?
         *      ==&gt; Parameters: 21(Integer), 24(Integer)
         */
    }

    /**
     *  测试
     *      between()       等同于 WHERE age between ? and ?
     *      notBetween()    等同于 WHERE age not between ? and ?
     *  +
     *  使用 selectList() 返回多个 非指定类型对象 的集合
     *
     */
    @Test
    public void abstractWrapperTest_between() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .between("age", 18,24)
                .notBetween("id",0,11);// 支持链式调用

        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE age BETWEEN ? AND ? AND id NOT BETWEEN ? AND ?
                 ==&gt; Parameters: 18(Integer), 24(Integer), 0(Integer), 11(Integer)
         */
    }

    /**
     *  测试
     *      like()              等同于 LIKE '%?%'
     *      notLike()           等同于 NOT LIKE '%?%'
     *      likeLeft()          等同于 LIKE '%?'
     *      likeRight()         等同于 LIKE '?%'
     *  +
     *  使用 selectCount()   返回查询到的条数
     */
    @Test
    public void abstractWrapperTest_like() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .like("email", "test")
                .notLike("email","test4")
                .likeRight("name","J") // J%
                .likeLeft("name","e"); //%e
        Integer selectCount = userMapper.selectCount(userQueryWrapper);
        System.out.println(selectCount);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE email LIKE ? AND email NOT LIKE ? AND name LIKE ? AND name LIKE ?
                 ==&gt; Parameters: %test%(String), %test4%(String), J%(String), %e(String)
         */
    }

    /**
     *  测试
     *      null()              等同于 is null
     *      isNotNull()         等同于 is not null
     *
     */
    @Test
    public void abstractWrapperTest_null() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
               .isNotNull("name");
        Integer selectCount = userMapper.selectCount(userQueryWrapper);
        System.out.println(selectCount);
        /**
         * 输出:
             ==&gt;  Preparing: SELECT COUNT(1) FROM user WHERE name IS NOT NULL
             ==&gt; Parameters:
             &lt;==    Columns: COUNT(1)
         */
    }

    /**
     *  测试
     *      in()              等同于 IN (?,?)
     *      notIn()           等同于 NOT IN (?,?)
     *      inSql()           等同于 IN (sql)
     *      notInSql()        等同于 NOT IN (sql)
     */
    @Test
    public void abstractWrapperTest_in() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        List&lt;Long&gt; idLists = new ArrayList&lt;&gt;();
        idLists.add(11L);
        idLists.add(13L);
        userQueryWrapper
               // .in("id",idLists);
                .inSql("id","select id from user where id&lt;=15");
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id IN (select id from user where id&lt;=15)
                 ==&gt; Parameters:
         */
    }

    /**
     *  测试
     *      groupBy() .. 支持多参数    等同于 GROUP BY age,name,id
     */
    @Test
    public void abstractWrapperTest_group() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .groupBy("age","name","id");
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
             ==&gt;  Preparing: SELECT id,name,age,email FROM user GROUP BY age,name,id
             ==&gt; Parameters:
         */
    }

    /**
     *  测试
     *      orderBy()     .. 支持多参数    等同于 关于 condition
     *      orderByDesc() .. 支持多参数    等同于 ORDER BY age DESC , id DESC
     *      orderByAsc()  .. 支持多参数    等同于 ORDER BY age ASC , id ASC
     */
    @Test
    public void abstractWrapperTest_order() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .orderByAsc("age","id");
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
             ==&gt;  Preparing: SELECT id,name,age,email FROM user ORDER BY age ASC , id ASC
             ==&gt; Parameters:
         */
    }

    /**
     *  测试
     *      having()     .. 支持多参数    等同于 HAVING sum(id)&gt; ?
     */
    @Test
    public void abstractWrapperTest_having() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .groupBy("age")
                .having("sum(id)&gt;{0}",20);// 替换里面的参数
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user GROUP BY age HAVING sum(id)&gt;?
                 ==&gt; Parameters: 20(Integer)
         */
    }

    /**
     *  测试
     *      or()       等同于 or
     *      and()       等同于 and
     */
    @Test
    public void abstractWrapperTest_or_and() {
        // 简单 or 和and
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .eq("id",11)
                .or()  // 默认and()
//                .and() // 两个不能连用
                .eq("id",13);
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id = ? OR id = ?
                 ==&gt; Parameters: 11(Integer), 13(Integer)
         */

        // 嵌套的 or 和and
        QueryWrapper&lt;User&gt; userQueryWrapper1 = new QueryWrapper&lt;&gt;();
        userQueryWrapper1
                .eq("id",14)
                .or(i -&gt; i.eq("name", "Lynwood").ne("age", "18"));
        List&lt;User&gt; userList1 = userMapper.selectList(userQueryWrapper1);
        userList1.forEach(System.out::println);
        /**输出:
         *
         * ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id = ? OR ( name = ? AND age &lt;&gt; ? )
         * ==&gt; Parameters: 14(Integer), Lynwood(String), 18(String)
         */
        /**!!!!!!!!!!!!  .or(i -&gt; i.eq("name", "Lynwood").ne("age", "18"));  解释  见下文发现问题*/
    }

    /**
     *  测试
     *      apply()    动态传参防止 sql注入    占位符 替换 以值的形式添加
     */
    @Test
    public void abstractWrapperTest_apply() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
               .apply("id&gt;{0}",13);
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE id&gt;?
                 ==&gt; Parameters: 13(Integer)
         */
    }

    /**
     *  测试
     *      last()   在sql 最后追加
     *
     *      最常用 last("limit 1")
     */
    @Test
    public void abstractWrapperTest_last() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
               .last("limit 2");
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user limit 2
                 ==&gt; Parameters:
         */
    }

    /**
     *  测试
     *      exists()  拼接 EXISTS ( sql语句 )
     *      notExists()  拼接 NOT EXISTS ( sql语句 )
     */
    @Test
    public void abstractWrapperTest_exists() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .exists("SELECT id,name,age,email FROM user where id= 222");
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE EXISTS (SELECT id,name,age,email FROM user where id= 222)
                 ==&gt; Parameters:
                 &lt;==      Total: 0
         */
    }

    /**
     *  测试
     *      nested()  正常嵌套  (无 or and 模式嵌套)
     */
    @Test
    public void abstractWrapperTest_nested() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper
                .nested(i -&gt; i.eq("name", "Lynwood").eq("age", "18"));
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
        /**
         * 输出:
                 ==&gt;  Preparing: SELECT id,name,age,email FROM user WHERE ( name = ? AND age = ? )
                 ==&gt; Parameters: Lynwood(String), 18(String)
         */
    }
}

</pre><h5><a name='header-n362' class='md-header-anchor '></a><strong>发现问题</strong>: <code>boolean condition</code> 、<code>R column</code>和 <code>Function&lt;This, This&gt; func</code> 三个参数相关问题</h5><h6><a name='header-n363' class='md-header-anchor '></a>说明及使用:</h6><p><span>	</span>Demo 中有  测试链接:<a href='https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperParamTests.java' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationAbstractWrapperParamTests.java</a></p><h6><a name='header-n365' class='md-header-anchor '></a>1.关于入参: <code>boolean condition</code> </h6><blockquote><ul><li><strong>以下出现的第一个入参<code>boolean condition</code>表示该条件<em>是否加入最后生成的sql中</em>,默认是true</strong></li></ul></blockquote><p>使用<code>ne()</code> 方法举例  源码 :</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n371" mdtype="fences">   @Override
    public This ne(boolean condition, R column, Object val) {
        return addCondition(condition, column, NE, val);
    }
</pre><p>测试编写:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n373" mdtype="fences">   /**
     *  测试 boolean condition
     */
    @Test
    public void abstractWrapperTest_Condition() {
        Integer age = new Random().nextInt(25);
        System.out.println("年龄: " + age);
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        boolean condition = age&lt;=18;
        userQueryWrapper.ne(condition,"name","Lynwood");
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
    }
</pre><p><span>	</span>生成的随机数age 小于18岁的 不要让他查到<code>name=&quot;Lynwood&quot;</code>的信息</p><p>再此看来<strong>等同于</strong><code>*mapper.xml</code>配置 </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="xml" contenteditable="false" cid="n376" mdtype="fences">WHERE 1=1  
&lt;if test="age &lt;= 18"&gt;
    AND name &lt;&gt; #{name}
&lt;/if&gt;
</pre><p>帮我们提入到了每个方法中,并且省去我们关系 是否写<code>AND</code>关键字或者 必须有 <code>WHERE 1=1</code>这些难看却又不必要的配置</p><h6><a name='header-n378' class='md-header-anchor '></a>2.关于入参: <code>R column</code> </h6><blockquote><ul><li>以下方法在入参中出现的<code>R</code>为<strong>泛型,</strong>在普通wrapper中是<code>String</code>,在LambdaWrapper中是<strong>函数</strong>(例:<code>Entity::getId</code>,<code>Entity</code>为实体类,<code>getId</code>为字段<code>id</code>的<strong>getMethod</strong>)</li><li>以下方法入参中的<code>R column</code>均表示数据库字段,当<code>R</code>为<code>String</code>时则为数据库字段名(<strong>字段名是数据库关键字的自己用转义符包裹!</strong>)!而不是实体类数据字段名!!!</li></ul></blockquote><p>查看源码 发现实际上 <code>eq()、ne()...</code> 等需要传入<code>R column</code>的方法实际最后<strong>都是调用</strong>了<code>addCondition(...)</code> 方法</p><p><img src='assets/1547174994254.png' alt='1547174994254' referrerPolicy='no-referrer' /></p><p>对 <code>R column</code>参数做了 <code>columnToString(column)</code>操作</p><p>而 <code>AbstractWrapper</code>实际中的<strong>此方法是抽象</strong>的: </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n389" mdtype="fences">    /**
     * 获取 columnName
     */
    protected abstract String columnToString(R column);
</pre><p><img src='assets/1547175323184.png' alt='1547175323184' referrerPolicy='no-referrer' /></p><p>而我们再去查看我们使用的 <code>QueryWrapper</code>与<code>UpdateWrapper</code> 中的<strong>具体实现</strong>都为:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n392" mdtype="fences">  @Override
    protected String columnToString(String column) {
        return column;
    }
</pre><p>实际上是转换成了<code>String</code>类型, <strong>那么为什么使用了泛型呢</strong>?</p><p>我们再返回去查看他的<strong>另一个实现类</strong><code>AbstractLambdaWrapper</code> 中的实现:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n395" mdtype="fences">@Override
protected String columnToString(SFunction&lt;T, ?&gt; column) {
    return getColumn(LambdaUtils.resolve(column));
}
</pre><p>原来这里<strong>使用泛型</strong> 为了<strong>扩展Lambda方式</strong>使用!</p><blockquote><h3><a name='header-n398' class='md-header-anchor '></a>lambda</h3><ul><li>获取 <code>LambdaWrapper</code>
在<code>QueryWrapper</code>中是获取<code>LambdaQueryWrapper</code>
在<code>UpdateWrapper</code>中是获取<code>LambdaUpdateWrapper</code></li></ul></blockquote><p>测试:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n403" mdtype="fences">    /**
     *  测试 R column
     */
    @Test
    public void abstractWrapperTest_Column() {
  		QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
//        userQueryWrapper.ne("name","Lynwood");
        userQueryWrapper.lambda().eq(User::getName,"Lynwood");
        
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
    }

</pre><h6><a name='header-n404' class='md-header-anchor '></a>3.关于入参: <code>Function&lt;This, This&gt; func</code> </h6><p><strong>其实再测试AbstractWrapper中的 or/and 嵌套中已经使用过了</strong></p><p>以<code>or()</code>举例  </p><p><span>	</span>需要<strong>传入的是</strong>  <code>Function</code><strong>的实现</strong>  而<code>Function</code>的定义是: </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n408" mdtype="fences">/**
 * Represents a function that accepts one argument and produces a result.
 *	表示接受一个参数执行生成结果的函数对象。
 * @since 1.8
 */
@FunctionalInterface
public interface Function&lt;T, R&gt; {
</pre><p>在我们使用过程中 往往是为了<strong>嵌套</strong> 我们传入的可能是另一个Wrapper 让他和当前的Wrapper去链接/嵌套起来</p><p>那么在:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n411" mdtype="fences">  userQueryWrapper.ne("name","Lynwood")
                        .or(i -&gt; i.eq("age", "18"));
</pre><p>中 我们实际上传入了一个匿名的Wrapper对象,那么这个<strong>匿名的Wrapper对象怎么符合了Function的要求呢</strong></p><p>我们查看这个<code>i</code>变量 : <img src='assets/1547179827539.png' alt='1547179827539' referrerPolicy='no-referrer' /></p><p>&nbsp;</p><p>他的类型是与调用对象一致的  查看 <code>QueryWrapper&lt;User&gt;</code>的继承关系:</p><p><img src='assets/1547179917168.png' alt='1547179917168' referrerPolicy='no-referrer' /></p><p>实际上我们使用的所有接口都去间接继承了<code>ISqlSegment</code> 接口 ,而它:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n418" mdtype="fences">package com.baomidou.mybatisplus.core.conditions;
@FunctionalInterface
public interface ISqlSegment extends Serializable {

</pre><p>是被@FunctionalInterface 标识的  与:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n420" mdtype="fences">package java.util.function;
@FunctionalInterface
public interface Function&lt;T, R&gt; {
</pre><p>是一样的, 所以我们使用它可以这样简便的使用啦:</p><p>测试:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n423" mdtype="fences" style="break-inside: unset;"> @Test
    public void abstractWrapperTest_Func() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
        userQueryWrapper.ne("name","Lynwood");
        userQueryWrapper.or(new Function&lt;QueryWrapper&lt;User&gt;, QueryWrapper&lt;User&gt;&gt;() {
            @Override
            public QueryWrapper&lt;User&gt; apply(QueryWrapper&lt;User&gt; userQueryWrapper) {
                return userQueryWrapper.eq("age", "18");
            }
        });
        // 等同与
        // userQueryWrapper.ne("name","Lynwood")
        //                        .or(i -&gt; i.eq("age", "18"));
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
        userList.forEach(System.out::println);
    }
</pre><hr /><h6><a name='header-n425' class='md-header-anchor '></a>二&gt; 编写QueryWrapper与UpdateWrapper测试类:</h6><p>Demo 中有  链接:<a href='https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationQueryAndUpdateWrapperTests.java' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/blob/master/mp_wrapper_demo/src/test/java/com/lynwood/mp/mp_wrapper_demo/MpWrapperDemoApplicationQueryAndUpdateWrapperTests.java</a></p><p>其实在上面的所有测试中其<strong>返回值都是完全的装配到了实体对象</strong>中,但是有的时候 比如有个<strong>字段</strong>很大 很消耗内存,同时也<strong>用不到</strong>,那么我<strong>如何</strong>把他<strong>取消</strong>掉.设置返回值为我们需要的几个字段就好</p><p><code>select()</code>测试</p><h5><a name='header-n429' class='md-header-anchor '></a><strong>注意坑</strong>  在借用 <code>lambda()</code> 使用 lambda特性时!</h5><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n430" mdtype="fences" style="break-inside: unset;">    /**
     *  测试 QueryWrapper.select()
     *
     */
 @Test
    public void abstractWrapperTest_Select() {
        QueryWrapper&lt;User&gt; userQueryWrapper = new QueryWrapper&lt;&gt;();
//        userQueryWrapper.eq("age",18)
//                .select("id","name");
        userQueryWrapper.eq("age",18)
                .select(User.class,i -&gt; false);//只返回id
        List&lt;User&gt; userList = userMapper.selectList(userQueryWrapper);
            // SELECT id FROM user WHERE age = ?
        userList.forEach(System.out::println);

        //前方有坑 注意: 注意!!!!!!!!!!!

        //关于LambdaQueryWrapper的使用这样用是没问题的
        LambdaQueryWrapper&lt;User&gt; lambdaQueryWrapper = new QueryWrapper&lt;User&gt;().lambda();
        lambdaQueryWrapper.select(User::getId,User::getAge);
        List&lt;User&gt; userList1 = userMapper.selectList(lambdaQueryWrapper);
            //SELECT id,age FROM user
        userList1.forEach(System.out::println);

        // 这样设置是无效的!!!!
        QueryWrapper&lt;User&gt; userQueryWrapper2 = new QueryWrapper&lt;&gt;();
        userQueryWrapper2.lambda().select(User::getId,User::getAge);
        List&lt;User&gt; userList2 = userMapper.selectList(userQueryWrapper2);
            // SELECT id,name,age,email FROM user
        userList2.forEach(System.out::println);
    }

</pre><p><code>set() setSql()</code> 测试</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n432" mdtype="fences" style="break-inside: unset;">	/**
     *  测试 UpdateWrapper.set()
     *  测试 UpdateWrapper.setSql()
     */
    @Test
    public void abstractWrapperTest_Set() {
        UpdateWrapper&lt;User&gt; userUpdateWrapper = new UpdateWrapper&lt;&gt;();
        // 更新id==11 的age 为19
        userUpdateWrapper.set("age",19).eq("id",11);
        // 附加更新内容 name 设置
        User user = new User();
        user.setName("Lynwood1");
        userMapper.update(user,userUpdateWrapper);
        /**
         *          ==&gt;  Preparing: UPDATE user SET name=?, age=? WHERE id = ?
         *          ==&gt; Parameters: Lynwood1(String), 19(Integer), 11(Integer)
         *          &lt;==    Updates: 1
         */

        UpdateWrapper&lt;User&gt; userUpdateWrapper1 = new UpdateWrapper&lt;&gt;();
        userUpdateWrapper1.setSql("name='wunian7yulian'").eq("id",11);
        // 附加更新内容为空时  不能传入null  需要传入空实体对象
        userMapper.update(new User(),userUpdateWrapper1);
        /**
         *      ==&gt;  Preparing: UPDATE user SET name='wunian7yulian' WHERE id = ?
         *      ==&gt; Parameters: 11(Integer)
         *      &lt;==    Updates: 1
         */
    }
</pre><h2><a name='header-n433' class='md-header-anchor '></a>六、插件及扩展 </h2><h3><a name='header-n434' class='md-header-anchor '></a>Demo代码地址：</h3><p><a href='https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_plugin_demo' target='_blank' class='url'>https://github.com/wunian7yulian/MybatisPlusDemo/tree/master/mp_plugin_demo</a><span>	</span></p><p>初始化:</p><p><span>	</span>因为下面演示需要其他字段,所以<strong>重新创建</strong>一个便于Demo的合适的<strong>表</strong>格:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="sql" contenteditable="false" cid="n438" mdtype="fences" style="break-inside: unset;">-- 创建简单表格
DROP TABLE IF EXISTS user;

CREATE TABLE `user` (
  `id` bigint(20) PRIMARY KEY AUTO_INCREMENT  COMMENT '主键ID',
  `name` varchar(30) DEFAULT NULL COMMENT '姓名',
  `age` int(11) DEFAULT NULL COMMENT '年龄',
  `email` varchar(50) DEFAULT NULL COMMENT '邮箱'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO user ( name, age, email) VALUES
('Jone', 18, 'test1@test.com'),
('Jack', 20, 'test2@test.com'),
('Tom', 28, 'test3@test.com'),
('Sandy', 21, 'test4@test.com'),
('Billie', 24, 'test5@test.com'),
('Lynwood', 18, 'wunian_@hotmail.com');
</pre><h3><a name='header-n439' class='md-header-anchor '></a>工程：</h3><h4><a name='header-n440' class='md-header-anchor '></a>第一 --&gt;第四步、同上</h4><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="yaml" contenteditable="false" cid="n441" mdtype="fences">spring:
  datasource:
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf-8
    username: root
    password: 123456

mybatis-plus:
  global-config:
    db-config:
      id-type: auto
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
</pre><h4><a name='header-n442' class='md-header-anchor '></a>第五步、插件使用</h4><h5><a name='header-n443' class='md-header-anchor '></a>分页插件:</h5><p><span>	</span>之前做列表或者报表功能时使用最多的是<code>pageHelper</code>插件做Mybatis的分页查询,MP为了方便将分页做了一个相关的模块<code>com.baomidou.mybatisplus.extension.plugins.pagination</code>供我们分页查询时去使用.</p><h6><a name='header-n445' class='md-header-anchor '></a>1、创建一个MP插件的配置类:</h6><p>在business目录下创建config目录 并在该目录下创建<code>MybatisPlusConfig.java</code>  添加<code>@Configuration</code>注解声明</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n447" mdtype="fences">@Configuration
public class MybatisPlusConfig {
    
}
</pre><h6><a name='header-n448' class='md-header-anchor '></a>2、配置分页插件</h6><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n449" mdtype="fences">@Configuration
public class MybatisPlusConfig {
    @Bean
    public PaginationInterceptor paginationInterceptor() {
        return new PaginationInterceptor();
    }
}
</pre><h6><a name='header-n450' class='md-header-anchor '></a>3、编写测试</h6><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n451" mdtype="fences" style="break-inside: unset;">@RunWith(SpringRunner.class)
@SpringBootTest
public class MpPluginDemoApplicationTests {
    @Autowired
    private UserMapper userMapper;
    /**
     * 测试分页插件
     */
    @Test
    public void test_page() {
        IPage&lt;User&gt; userIPage = userMapper.selectPage(
                  new Page&lt;User&gt;()
                        .setCurrent(1) //设置当前查询页
                        .setSize(3) // 设置每页条数
                        .setDesc("age"),//使用page 进行排序
                new QueryWrapper&lt;User&gt;()
                        .lambda()
                        .likeRight(User::getEmail, "test")
                        .select(User::getId, User::getName, User::getAge)
        );

        List&lt;User&gt; records = userIPage.getRecords();
        records.forEach(System.out::println);
        /**
         * ==&gt;  Preparing: SELECT id,name,age FROM user WHERE email LIKE ? ORDER BY age DESC LIMIT ?,?
         * ==&gt; Parameters: test%(String), 0(Long), 3(Long)
         */
    }
}

</pre><p>完美!  不过因为<code>page</code>对象在<code>3.0.6</code>版本还没有支持lambda方式 page上在设置排序字段时 还是会有一些魔法值出现,不过我们也是可以直接将 排序 写在wrapper里的.  有强迫症的童鞋等待<code>3.1.0</code>版本吧.</p><h5><a name='header-n453' class='md-header-anchor '></a>逻辑删除插件:</h5><h6><a name='header-n454' class='md-header-anchor '></a>1、yaml添加逻辑值制定配置：</h6><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="yaml" contenteditable="false" cid="n455" mdtype="fences" style="break-inside: unset;">spring:
  datasource:
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://127.0.0.1:3306/mp_demo_db?characterEncoding=utf-8
    username: root
    password: 123456

mybatis-plus:
  global-config:
    db-config:
      id-type: auto
      logic-delete-value: 1 # 逻辑已删除值(默认为 1)
      logic-not-delete-value: 0 # 逻辑未删除值(默认为 0)
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
</pre><h6><a name='header-n456' class='md-header-anchor '></a>2、配置逻辑插件:</h6><p>在MybatisPlusConfig中添加插件bean</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n458" mdtype="fences">@Configuration
public class MybatisPlusConfig {
 	...
    @Bean
    public ISqlInjector sqlInjector() {
        return new LogicSqlInjector();
    }
}
</pre><h6><a name='header-n459' class='md-header-anchor '></a>3、标识逻辑字段:</h6><p>在<code>User</code>中的 del字段上添加<code>@TableLogic</code>注解</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n461" mdtype="fences">@Data
@EqualsAndHashCode(callSuper = false)
@Accessors(chain = true)
public class User implements Serializable {
	...
    /**
     * 逻辑删除 0-未删除 1-删除
     */
    @TableLogic
    private Integer del;
    ...
}
</pre><h6><a name='header-n462' class='md-header-anchor '></a>4、编写测试</h6><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n463" mdtype="fences" style="break-inside: unset;"> /**
     * 测试逻辑删除插件
     */ 
    @Test
    public void test_logic_delete() {
        userMapper.delete(new QueryWrapper&lt;User&gt;()
                .lambda()
                .notLike(User::getEmail, "test")
                .select(User::getId, User::getName, User::getAge));
        /**
         * ==&gt;  Preparing: UPDATE user SET del=1 WHERE del=0 AND email NOT LIKE ?
         * ==&gt; Parameters: %test%(String)
         */
        //那么查询呢?
        List&lt;User&gt; userList = userMapper.selectList(null);
        userList.forEach(System.out::println);
        //发现查询也帮我们设置了过滤字段  del = 0
        /**
         * ==&gt;  Preparing: SELECT id,name,age,email,del,version FROM user WHERE del=0
         * ==&gt; Parameters:
         */

        //那么我想查出这个删除的用户 更改为 正常呢?
        List&lt;Map&lt;String, Object&gt;&gt; mapList = userMapper.selectMaps(
                new QueryWrapper&lt;User&gt;()
                        .lambda()
                        .eq(User::getDel, 1)
                        .select(User.class,i -&gt; false)
        );
        Assert.assertNotNull(mapList);
        Assert.assertEquals(mapList.size(),1);
        /**  select id from user where del = 0 and del = 1
         * java.lang.AssertionError:
         * Expected :0
         * Actual   :1
         */
        // 失败了
        //

    }
</pre><p>询问MP开发者后 开发者说明 因为大部分情况在删除之后不会恢复 所以<strong>没有设定相关恢复或者跳过 当前 筛选的</strong> 接口</p><h5><a name='header-n465' class='md-header-anchor '></a>乐观锁:</h5><h6><a name='header-n466' class='md-header-anchor '></a>主要适用场景</h6><p>当要更新一条记录的时候，希望这条记录没有被别人更新</p><p>特别说明:</p><ul><li><strong>支持的数据类型只有:int,Integer,long,Long,Date,Timestamp,LocalDateTime</strong></li><li>整数类型下 <code>newVersion = oldVersion + 1</code></li><li><code>newVersion</code> 会回写到 <code>entity</code> 中</li><li><strong>仅支持</strong> <code>updateById(id)</code> 与 <code>update(entity, wrapper)</code> 方法</li><li><strong>在 update(entity, wrapper) 方法下, wrapper 不能复用!!!</strong></li></ul><p>乐观锁实现方式：</p><ul><li>取出记录时，获取当前version</li><li>更新时，带上这个version</li><li>执行更新时， set version = newVersion where version = oldVersion</li><li>如果version不对，就更新失败</li></ul><p>1、配置乐观锁插件：</p><p>在<code>MybatisPlusConfig</code>添加：</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n492" mdtype="fences">@Bean
public OptimisticLockerInterceptor optimisticLockerInterceptor() {
    return new OptimisticLockerInterceptor();
}
</pre><p>2、添加乐观锁版本字段注解:</p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n494" mdtype="fences">@Data
@EqualsAndHashCode(callSuper = false)
@Accessors(chain = true)
public class User implements Serializable {
	...
    /**
     * 乐观锁版本字段
     */
    @Version
    private Integer version;
}
</pre><p>3、编写测试类: </p><pre spellcheck="false" class="md-fences mock-cm md-end-block" lang="java" contenteditable="false" cid="n496" mdtype="fences" style="break-inside: unset;">/**
     * 测试乐观锁插件
     */
    @Test
    public void test_Optimistic_Locking() throws InterruptedException {
        User oldUser = userMapper.selectById(1);
        oldUser.setAge(19);
        System.out.println("模拟中途有人更改"+ "begin....");
        Thread.sleep(10000);
        System.out.println("模拟中途有人更改"+ "end....");
        if(userMapper.updateById(oldUser)==1){
            System.out.println("success \n"+ oldUser);
            //success
            //User(id=1, name=Jone, age=19, email=test1@test.com, del=0, version=2)
        }else {
            System.out.println("fail \n");
            //==&gt;  Preparing: UPDATE user SET name=?, age=?, email=?, version=? WHERE id=? AND version=? AND del=0
            //==&gt; Parameters: Jone(String), 19(Integer), test1@test.com(String), 3(Integer), 1(Long), 2(Integer)
            //&lt;==    Updates: 0
            //fail
        }
    }
</pre><p>其他插件 如 热加载等 如有需要 再做更新</p><h2><a name='header-n498' class='md-header-anchor '></a>七 、总结</h2><p>MP优秀于简化了Mybatis大部分XML配置 将他归总到起来生成一个强大的Wrapper </p><p>现有MP也是有了两个版本大的版本2.x与3.x ,酌情使用比较合理 3.x虽然有了Lambda的支持但是还不完善,</p><p>后续版本的更新应该也会去查漏现版本的缺陷.</p><p>对于插件,像乐观锁分页逻辑删真的是贴心,不过也有相对应场景不适用问题,比如上面说到的逻辑删除的我还要查是查不到的,还是需要去自定义sql的</p><p>我相信 有了mp这种强大的利器,对于一个微型项目 或者微服务 来说真的是爽,写起来真的是非常有效率</p><p>&nbsp;</p><p>个人--<span>	</span></p><p><span>	</span>作为头一个被我收拾的应用层框架,看到了开发者的用心和初心, 看来排上名并不是那么绝非偶然,也并非那么&quot;功力深厚&quot;,只要你有想法开始做,总有一个好的结果.</p><p>&nbsp;</p><p>下一框架寻找中... </p><p>&nbsp;</p><h2><a name='header-n510' class='md-header-anchor '></a>参考文档：</h2><blockquote><p>MyBatis-Plus 官方文档 : <a href='https://mp.baomidou.com/' target='_blank' class='url'>https://mp.baomidou.com/</a> </p><p>MyBatis-Plus 配置进阶 : <a href='https://mp.baomidou.com/config/' target='_blank' class='url'>https://mp.baomidou.com/config/</a> </p><p>MyBatis-Plus 代码生成器配置 : <a href='https://mp.baomidou.com/config/generator-config.html' target='_blank' class='url'>https://mp.baomidou.com/config/generator-config.html</a> </p><p>MyBatis-Plus sql注入原理 :  <a href='https://www.liangzl.com/get-article-detail-19831.html' target='_blank' class='url'>https://www.liangzl.com/get-article-detail-19831.html</a> </p><p>Mybatis-Plus 使用全解 : <a href='https://www.jianshu.com/p/7299cba2adec' target='_blank' class='url'>https://www.jianshu.com/p/7299cba2adec</a> </p></blockquote></div>
</body>
</html>